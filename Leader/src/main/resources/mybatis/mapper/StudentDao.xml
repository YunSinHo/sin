<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ld.admin.dao.IStudentDao">
 <select id="studentList" resultType="com.ld.user.vo.StudentVO">
   select * from student
   </select>
   <select id="studentListSelect" resultType="com.ld.user.vo.StudentVO" parameterType="String">
   select * from student where parentnumber in
   <foreach collection="array" item="arr" open="(" close=")" separator=",">
 #{arr}
</foreach>
   </select>
   <select id="carrotList1" resultType="com.ld.admin.vo.CarrotVO" parameterType="String">
   select * from carrot_table where carrot_number=#{param1} order by carrot_date desc
   </select>
    <select id="studentList1" resultType="com.ld.user.vo.StudentVO" parameterType="String">
   select * from student where parentnumber=#{parentnumber}
   </select>
   <select id="loginStudent" resultType="com.ld.user.vo.StudentVO" parameterType="String">
    select * from student where stuid=#{param1} and CONVERT(AES_DECRYPT(unhex(password), SHA2('bockgipoog541354',256)) USING utf8)=#{param2};
   </select>
   
   <select id="studentClassList" resultType="com.ld.user.vo.StudentClassVO" parameterType="int">
   	select * from student_class where student_id=#{param1} 
   </select>
    <select id="studentClassListAll" resultType="com.ld.user.vo.StudentClassVO" parameterType="int">
   	select * from student_class where student_id=#{param1}
   </select>
   <select id="studentClassName" resultType="String" parameterType="int">
   	select name from student_class where student_id=#{param1}
   </select>
   
   <insert id="insertStudent" parameterType="com.ld.user.vo.StudentVO">
   	insert into student(stuid,password,parentnumber,number,grade,school,name) values
   	(#{stuid},hex(aes_encrypt(#{password}, SHA2('bockgipoog541354',256))),#{parentnumber},#{number},#{grade},#{school},#{name})
   </insert>
   
   <select id="studentClassId" resultType="com.ld.admin.vo.StudentClassAllVO" >
   		select student.id as id,student.name as name,student.stuid as stuid,student.grade as grade,group_concat(student_class.name) as class_name from student
   		 left join
 student_class on student.id=student_class.student_id
 group by student.name,student.stuid;
   </select>
   
   <select id="studentClassCount" resultType="int" parameterType="int">
   	select count(*) from student_class where student_id=#{param1}
   </select>
   <!-- 학생 클래스 추가 -->
   <insert id="insertStudentClass">
   insert into student_class (student_id,name) values(#{param1},#{param2})
   </insert>
   <!-- 학생 클래스 삭제 -->
   <delete id="deleteStudentClass">
   	delete from student_class where student_id=#{param1} and name=#{param2}
   </delete>
</mapper>